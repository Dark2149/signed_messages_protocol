Отправитель шифрует сообщение открытым ключом получателя, затем ставит свою подпись с помощью своего закрытого ключа. Получатель с помощью
своего закрытого ключа расшифровывает сообщение и проверяет хэш-сумму, которая должна сопоставляться с открытым ключом отправителя.
Хэш получается путём скармливания закрытого ключа отправителя хэш-функции. Естественно, круче когда коллизий мало.

Комментарии по реализации: для создания ключей используется генератор, который основывается на данных ОС. 
В save_keys используется кодирование. Т.е. ключи, где 24 бита кодируется 8 битами * 3, в base64, где 24 бита в 4 блока по 6. Таким образом,
можно безопасно передавать данные.